<!DOCTYPE html>
<html>

<head>
    <title>Setup</title>

    <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css">
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
    <script src="vendor/web3/web3.min.js"></script>
    <script src="js/env.js"></script>
</head>

<body>
    <section id="divNavPage"></section>
    <section class="container mt-5" style="max-width: 540px;">
        <div class="alert d-none" role="alert" id="divStatus">
        </div>
        <div class="card">
            <div class="card-body">
                <div class="mb-3">
                    <label for="ddlChain" class="form-label">Chain</label>
                    <select id="ddlChain" class="form-select" aria-label="Default select example">
                        <option selected>Select</option>
                        <option value="Sepolia">Sepolia</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="txtProjectType" class="form-label">Project Name</label>
                    <input class="form-control" id="txtProjectType">
                </div>
                <div class="mb-3">
                    <label for="txtRewardType" class="form-label">Reward Type</label>
                    <input class="form-control" id="txtRewardType">
                </div>
                <div class="mb-3">
                    <button id="btnSetup" class="btn btn-primary" onclick="deployContract()">Setup</button>
                </div>
            </div>
        </div>
    </section>
</body>

<script src="js/master.js"></script>
<script>
    async function deployContract(event) {
        event.preventDefault();

        var divStatus = document.getElementById('divStatus')
        try {
            // Deploy the contract
            const contract = new web3.eth.Contract(contractABI);
            const accounts = await web3.eth.getAccounts();
            const deployedContract = await contract.deploy({
                data: bytecode,
                arguments: [{
                    txtProjectType:document.getElementById('txtProjectType').value,
                    txtRewardType:document.getElementById('txtRewardType').value
                }] // If your constructor has arguments, pass them here
            }).send({
                from: accounts[0], // Update with the account you want to deploy from
                gas: 1500000 // Adjust gas value as needed
            });

            console.log('Contract deployed at address:', deployedContract.options.address);
            divStatus.innerHTML = 'Contract deployed at address:' + deployedContract.options.address;
            divStatus.classList.add('alert-success')
        } catch (error) {
            console.error('Error deploying contract:', error);
            divStatus.innerHTML = 'Error deploying contract:' + error;
            divStatus.classList.add('alert-danger')
        }
        divStatus.classList.remove('d-none')
    }

    document.getElementById("btnSetup").addEventListener("submit", deployContract);

</script>

</html>